<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <title>ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 20px; }
    video, canvas { width: 320px; height: 240px; margin-bottom: 10px; border: 1px solid #ccc; }
    canvas.signature { height: 150px; border: 1px dashed #000; }
    button { padding: 10px 20px; margin: 5px; background: green; color: white; border: none; border-radius: 5px; }
    #result { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <h2>ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи</h2>

  <video id="video" autoplay muted playsinline></video><br>
  <button id="startBtn">ЁЯОе рж░рзЗржХрж░рзНржб рж╢рзБрж░рзБ</button>

  <h3>тЬНя╕П рж╕рзНржмрж╛ржХрзНрж╖рж░</h3>
  <canvas id="signCanvas" class="signature" width="320" height="150"></canvas><br>
  <button id="clearSign">ЁЯз╣ ржорзБржЫрзБржи</button>
  <button id="submitBtn" disabled>ЁЯУд рж╕рж╛ржмржорж┐ржЯ</button>

  <p id="result">ржкрзНрж░рж╕рзНрждрзБржд...</p>

  <script>
    const video = document.getElementById('video');
    const startBtn = document.getElementById('startBtn');
    const signCanvas = document.getElementById('signCanvas');
    const signCtx = signCanvas.getContext('2d');
    const clearSign = document.getElementById('clearSign');
    const submitBtn = document.getElementById('submitBtn');
    const result = document.getElementById('result');

    let stream, mediaRecorder, videoBlob;
    let drawing = false;
    let recordedChunks = [];

    // ржХрзНржпрж╛ржорзЗрж░рж╛ ржЪрж╛рж▓рзБ
    async function startCamera() {
      try {
        stream = await navigator.mediaDevices.getUserMedia({ video: true });
        video.srcObject = stream;
      } catch (err) {
        alert("ржХрзНржпрж╛ржорзЗрж░рж╛ ржЪрж╛рж▓рзБ рж╣рзЯржирж┐: " + err.message);
      }
    }

    // рж░рзЗржХрж░рзНржб рж╢рзБрж░рзБ
    startBtn.onclick = () => {
      if (!stream) return;
      recordedChunks = [];
      mediaRecorder = new MediaRecorder(stream);
      mediaRecorder.ondataavailable = e => recordedChunks.push(e.data);
      mediaRecorder.onstop = () => {
        videoBlob = new Blob(recordedChunks, { type: 'video/webm' });
        stopCamera();
        result.textContent = 'тЬЕ ржнрж┐ржбрж┐ржУ рж░рзЗржХрж░рзНржб рж╕ржорзНржкржирзНржи рж╣рзЯрзЗржЫрзЗ, ржПржЦржи рж╕рзНржмрж╛ржХрзНрж╖рж░ ржжрж┐ржиред';
        submitBtn.disabled = false;
      };
      mediaRecorder.start();
      result.textContent = 'ЁЯФ┤ рж░рзЗржХрж░рзНржбрж┐ржВ ржЪрж▓ржЫрзЗ...';
      startBtn.disabled = true;
      setTimeout(() => {
        mediaRecorder.stop();
      }, 5000);
    };

    // ржХрзНржпрж╛ржорзЗрж░рж╛ ржмржирзНржз
    function stopCamera() {
      stream.getTracks().forEach(track => track.stop());
      video.style.display = 'none';
    }

    // рж╕рж╛ржЗржи ржЖржБржХрж╛
    signCanvas.addEventListener('mousedown', () => { drawing = true; signCtx.beginPath(); });
    signCanvas.addEventListener('mouseup', () => drawing = false);
    signCanvas.addEventListener('mousemove', e => {
      if (!drawing) return;
      const rect = signCanvas.getBoundingClientRect();
      signCtx.lineWidth = 2;
      signCtx.strokeStyle = 'black';
      signCtx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
      signCtx.stroke();
      signCtx.beginPath();
      signCtx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
    });

    // рж╕рж╛ржЗржи ржорзБржЫрзБржи
    clearSign.onclick = () => {
      signCtx.clearRect(0, 0, signCanvas.width, signCanvas.height);
    };

    // рж╕рж╛ржмржорж┐ржЯ
    submitBtn.onclick = () => {
      if (!videoBlob) {
        alert("ржнрж┐ржбрж┐ржУ рж░рзЗржХрж░рзНржб рж╣рзЯржирж┐!");
        return;
      }
      result.textContent = "тЬЕ ржЖржкржирж╛рж░ ржнрзЗрж░рж┐ржлрж┐ржХрзЗрж╢ржи рж╕ржлрж▓ рж╣рзЯрзЗржЫрзЗ!";
      submitBtn.disabled = true;
    };

    startCamera();
  </script>
</body>
</html>
